function P3D(X,Y,Z){
  let d=p=0
  X-=camX
  Y-=camY
  Z-=camZ
  d=Math.hypot(X,Z)
  p=Math.atan2(X,Z)-camYaw
  X=S(p)*d
  Z=C(p)*d
  d=Math.hypot(Y,Z)
  p=Math.atan2(Y,Z)-camPitch
  Y=S(p)*d
  Z=C(p)*d
  if(Z>0) return [w+X/Z*w,h+Y/Z*w,Z]
}


function handleCamera(){

	if(mx){
		camYawV+=mx/400;
		mx=0;
	}
	if(my){
		camPitchV+=my/400;
		my=0;
	}
  let PRS=playerRotateSpeed
  if(leftkey){
    camYawV-=PRS
  }
  if(rightkey){
    camYawV+=PRS
  }
  if(upkey){
    camPitchV-=PRS
  }
  if(downkey){
    camPitchV+=PRS
  }
  camYaw+=camYawV
  camPitch+=camPitchV
  if(camPitch>Math.PI/2)camPitch=Math.PI/2
  if(camPitch<-Math.PI/2)camPitch=-Math.PI/2
  camYawV/=2
  camPitchV/=2
  let V=playerSpeed*(shiftkey?3:1)
  if(wkey){
    camVX+=Math.sin(camYaw)*Math.cos(camPitch)*V
    camVY+=Math.sin(camPitch)*V
    camVZ+=Math.cos(camYaw)*Math.cos(camPitch)*V
  }
  if(akey){
    camVX+=Math.sin(camYaw-Math.PI/2)*V
    camVZ+=Math.cos(camYaw-Math.PI/2)*V
  }
  if(skey){
    camVX-=Math.sin(camYaw)*Math.cos(camPitch)*V
    camVY-=Math.sin(camPitch)*V
    camVZ-=Math.cos(camYaw)*Math.cos(camPitch)*V
  }
  if(dkey){
    camVX+=Math.sin(camYaw+Math.PI/2)*V
    camVZ+=Math.cos(camYaw+Math.PI/2)*V
  }
  camX+=camVX
  camY+=camVY
  camZ+=camVZ
  if(camY<ceiling+1)camY=ceiling+1
  if(camY>floor-1)camY=floor-1
  camVX/=1.5
  camVY/=1.5
  camVZ/=1.5
}


function Seg(x1,y1,z1,x2,y2,z2){
	this.a={x:x1,y:y1,z:z1,vx:0,vy:0,vz:0};
	this.b={x:x2,y:y2,z:z2,vx:0,vy:0,vz:0};
}


function Cube(x,y,z, scale=1, color = "#fff"){
	Q={};
  Q.hit = 25;
	Q.x=x;
	Q.y=y;
	Q.z=z;
  Q.c=color;
  Q.scale=scale;
	Q.s=[];
  let v=.5
	Q.s.push(new Seg(-v,-v,-v,v,-v,-v));
	Q.s.push(new Seg(v,-v,-v,v,v,-v));
	Q.s.push(new Seg(v,v,-v,-v,v,-v));
	Q.s.push(new Seg(-v,v,-v,-v,-v,-v));
	Q.s.push(new Seg(-v,-v,v,v,-v,v));
	Q.s.push(new Seg(v,-v,v,v,v,v));
	Q.s.push(new Seg(v,v,v,-v,v,v));
	Q.s.push(new Seg(-v,v,v,-v,-v,v));
	Q.s.push(new Seg(-v,-v,-v,-v,-v,v));
	Q.s.push(new Seg(v,-v,-v,v,-v,v));
	Q.s.push(new Seg(v,v,-v,v,v,v));
	Q.s.push(new Seg(-v,v,-v,-v,v,v));
	return Q;
}


function rotateShape(shape, yaw, pitch, roll){
	var x,y,z,p,d;
	for(var i=0;i<shape.s.length;++i){
		for(var j=2;j--;){
			if(j){
				x=shape.s[i].a.x;
				y=shape.s[i].a.y;
				z=shape.s[i].a.z;
			}else{
				x=shape.s[i].b.x;
				y=shape.s[i].b.y;
				z=shape.s[i].b.z;
			}
			d=Math.sqrt(x*x+z*z);
			p=Math.atan2(x,z);
			x=Math.sin(p+yaw)*d;
			z=Math.cos(p+yaw)*d;
			d=Math.sqrt(y*y+z*z);
			p=Math.atan2(y,z);
			y=Math.sin(p+pitch)*d;
			z=Math.cos(p+pitch)*d;
			d=Math.sqrt(x*x+y*y);
			p=Math.atan2(x,y);
			x=Math.sin(p+roll)*d;
			y=Math.cos(p+roll)*d;
			if(j){
				shape.s[i].a.x=x;
				shape.s[i].a.y=y;
				shape.s[i].a.z=z;
			}else{
				shape.s[i].b.x=x;
				shape.s[i].b.y=y;
				shape.s[i].b.z=z;
			}
		}
	}
}

function mangleShape(shape){
	for(var i=0;i<shape.s.length;++i){
    let d=Math.hypot(shape.s[i].a.x-shape.s[i].b.x,shape.s[i].a.y-shape.s[i].b.y,shape.s[i].a.z-shape.s[i].b.z)
    shape.s[i].a.x*=1.1
    shape.s[i].a.y*=1.1
    shape.s[i].a.z*=1.1
    shape.s[i].b.x*=1.1
    shape.s[i].b.y*=1.1
    shape.s[i].b.z*=1.1
    let X=(shape.s[i].b.x-shape.s[i].a.x)/8
    let Y=(shape.s[i].b.y-shape.s[i].a.y)/8
    let Z=(shape.s[i].b.z-shape.s[i].a.z)/8
    shape.s[i].a.x+=X
    shape.s[i].a.y+=Y
    shape.s[i].a.z+=Z
    shape.s[i].b.x-=X
    shape.s[i].b.y-=Y
    shape.s[i].b.z-=Z
	}
}

function drawFloorAndCeiling(){

  let lw=X=Y=Z=P1=P2=0
  for(let l=0;l<2;++l){
    if(l==0&&!showCeiling)l++
    if(l==1&&!showFloor)break
    Y=l?floor:ceiling
    for(let m=0;m<6;++m){
      Z=(m-3)*gridSegs+Math.round(camZ/gridSegs)*gridSegs+gridSegs/2
      for(let k=0;k<6;++k){
        X=(k-3)*gridSegs+Math.round(camX/gridSegs)*gridSegs+gridSegs/2
        for(let i=0;i<gridSegs;i++){
          for(let j=0;j<gridSegs;j++){
            let d=Math.hypot(i-gridSegs/2+.5+X-camX,j-gridSegs/2+.5+Z-camZ)
            let a=1-Math.pow(d/(gridSegs*2.99),4)
            if(a>.1){
              x.globalAlpha=a
              if((P1=P3D(i-gridSegs/2+.5+X,Y,j-gridSegs/2+.5+Z)) && (P2=P3D(i-gridSegs/2+.5+X,Y,j-gridSegs/2+1.5+Z))){
                x.beginPath()
                if(!i){
                  lw=100
                  x.strokeStyle="#16f"
                }else{
                  lw=50
                  x.strokeStyle="#248"
                }
                x.lineWidth=lw/(1+P2[2]*P2[2])
                x.moveTo(...P1)
                x.lineTo(...P2)
                x.stroke()
              }
              if((P1=P3D(i-gridSegs/2+.5+X,Y,j-gridSegs/2+.5+Z)) && (P2=P3D(i-gridSegs/2+1.5+X,Y,j-gridSegs/2+.5+Z))){
                x.beginPath()
                if(!j){
                  lw=100
                  x.strokeStyle="#16f"
                }else{
                  lw=50
                  x.strokeStyle="#248"
                }
                x.lineWidth=lw/(1+P2[2]*P2[2])
                x.moveTo(...P1)
                x.lineTo(...P2)
                x.stroke()
              }
            }
          }
        }
      }
    }
    x.globalAlpha=1
  }
  if(showFloor){
    for(i=terrain.length;i--;){
      X=terrain[i].x
      Y=terrain[i].y-terrain[i].scale/2
      Z=terrain[i].z
      SC=terrain[i].scale
      let point=P3D(X,Y,Z)
      if(point){
        let d=Math.hypot(camX-X,camY-Y,camZ-Z)
        let a=1-Math.pow(d/(gridSegs*2.99),1.5)
        if(a>.01){
          x.globalAlpha=a<0?0:a
          x.strokeStyle=terrain[i].c;
          x.lineWidth=20/(1+point[2])
          x.beginPath()
          for(let j=12;j--;){
            pta=P3D(X+terrain[i].s[j].a.x,Y+terrain[i].s[j].a.y*SC,Z+terrain[i].s[j].a.z)
            ptb=P3D(X+terrain[i].s[j].b.x,Y+terrain[i].s[j].b.y*SC,Z+terrain[i].s[j].b.z)
            if(pta&&ptb){
              x.moveTo(...pta)
              x.lineTo(...ptb)
            }
          }
          x.stroke()
        }
      }
    }
    x.globalAlpha=1
  }
}


function clearScreen(){
  x.globalAlpha=.5
  x.fillStyle="#001"
  x.fillRect(0,0,w*2,h*2)
  x.globalAlpha=1
  if(showHud)x.drawImage(hud,0,0,w*2,h*2)
}


function drawShapes(){
  for(i=shapes.length;i--;){
		X=shapes[i].x
		Y=shapes[i].y
		Z=shapes[i].z
    SC=shapes[i].scale
		let point=P3D(X,Y,Z)
    if(point){
      a=.75-Math.pow(point[2]/fieldRadius,6)*.75
      x.globalAlpha=a<0?0:a
      x.strokeStyle=shapes[i].c;
      x.lineWidth=40/(1+point[2])
      x.beginPath()
      for(let j=12;j--;){
        pta=P3D(X+shapes[i].s[j].a.x*SC,Y+shapes[i].s[j].a.y*SC,Z+shapes[i].s[j].a.z*SC)
        ptb=P3D(X+shapes[i].s[j].b.x*SC,Y+shapes[i].s[j].b.y*SC,Z+shapes[i].s[j].b.z*SC)
        if(pta&&ptb){
          x.moveTo(...pta)
          x.lineTo(...ptb)
        }
      }
      x.stroke()
    }
	}
  x.globalAlpha=1
}


function handleShapes(){
  for(let i=0;i<terrain.length;i++){
    if(camX-terrain[i].x>fieldRadius)terrain[i].x+=fieldRadius*2
    if(camX-terrain[i].x<-fieldRadius)terrain[i].x-=fieldRadius*2
    if(camZ-terrain[i].z>fieldRadius)terrain[i].z+=fieldRadius*2
    if(camZ-terrain[i].z<-fieldRadius)terrain[i].z-=fieldRadius*2
  }
  for(let i=0;i<shapes.length;i++){
    if(camX-shapes[i].x>fieldRadius)shapes[i].x+=fieldRadius*2
    if(camX-shapes[i].x<-fieldRadius)shapes[i].x-=fieldRadius*2
    if(camZ-shapes[i].z>fieldRadius)shapes[i].z+=fieldRadius*2
    if(camZ-shapes[i].z<-fieldRadius)shapes[i].z-=fieldRadius*2

    if(Math.hypot(camX-shapes[i].x,camY-shapes[i].y,camZ-shapes[i].z)<playerRadius && shapes[i].hit == 25){
        playerCubeScore++; shapes[i].hit-- }

    if(shapes[i].hit < 25){
      mangleShape(shapes[i]);
      shapes[i].y -= .1;
      shapes[i].hit--;
    }else{
      rotateShape(shapes[i],.01,.02,.03)
    }
    if(shapes[i].hit < 0)shapes.splice(i,1);
  }
}


function handleModels(){
  for(let i=0;i<models.length;i++){
    if(camX-models[i].x>fieldRadius)models[i].x+=fieldRadius*2
    if(camX-models[i].x<-fieldRadius)models[i].x-=fieldRadius*2
    if(camZ-models[i].z>fieldRadius)models[i].z+=fieldRadius*2
    if(camZ-models[i].z<-fieldRadius)models[i].z-=fieldRadius*2
  }
}


function drawScore(){
  x.globalAlpha=1
  x.fillStyle="#4F4"
  x.font = "30px Arial"
  x.fillText('collected: '+playerCubeScore, 20, 40);
}


function drawModels(){
  let x=y=z=0
  for(let i=0;i<models.length;++i){
    let shape=models[i]
    shape.yaw-=.06
    for(j=0;j<shape.polys.length;++j){
      for(k=0;k<shape.polys[j].verts.length;++k){
        x=shape.polys[j].verts[k].x;
        y=shape.polys[j].verts[k].y;
        z=shape.polys[j].verts[k].z;
        p=Math.atan2(x,y);
        d=Math.sqrt(x*x+y*y);
        x=Math.sin(p+shape.roll)*d;
        y=Math.cos(p+shape.roll)*d;
        p=Math.atan2(y,z);
        d=Math.sqrt(y*y+z*z);
        y=shape.y+Math.sin(p+shape.pitch)*d;
        z=Math.cos(p+shape.pitch)*d;
        p=Math.atan2(x,z);
        d=Math.sqrt(x*x+z*z);
        x=shape.x+Math.sin(p+shape.yaw)*d;
        z=shape.z+Math.cos(p+shape.yaw)*d;
        point1=P3D(x,y,z);
        if(k==shape.polys[j].verts.length-1){
          x=shape.polys[j].verts[0].x;
          y=shape.polys[j].verts[0].y;
          z=shape.polys[j].verts[0].z;
        }else{
          x=shape.polys[j].verts[k+1].x;
          y=shape.polys[j].verts[k+1].y;
          z=shape.polys[j].verts[k+1].z;
        }
        p=Math.atan2(x,y);
        d=Math.sqrt(x*x+y*y);
        x=Math.sin(p+shape.roll)*d;
        y=Math.cos(p+shape.roll)*d;
        p=Math.atan2(y,z);
        d=Math.sqrt(y*y+z*z);
        y=shape.y+Math.sin(p+shape.pitch)*d;
        z=Math.cos(p+shape.pitch)*d;
        p=Math.atan2(x,z);
        d=Math.sqrt(x*x+z*z);
        x=shape.x+Math.sin(p+shape.yaw)*d;
        z=shape.z+Math.cos(p+shape.yaw)*d;
        point2=P3D(x,y,z);
        if(point1 && point2){
          ctx.strokeStyle="#1f8";//rgb2(pi*2/shapes.length*shape.id+.000001);
          width1=5/(1+point1[2]);
          width2=5/(1+point2[2]);
          a=.75-Math.pow(point1[2]/fieldRadius,2)*.75
          if(a>.1){
            ctx.globalAlpha=a;
            for(m=0;m<lineSubs;++m){
              ctx.lineWidth=width1+(width2-width1)/lineSubs*m;
              ctx.beginPath();
              x1=point1[0]+(point2[0]-point1[0])/lineSubs*m;
              y1=point1[1]+(point2[1]-point1[1])/lineSubs*m;
              x2=point1[0]+(point2[0]-point1[0])/lineSubs*(m+1);
              y2=point1[1]+(point2[1]-point1[1])/lineSubs*(m+1);
              ctx.moveTo(x1,y1);
              ctx.lineTo(x2,y2);
              ctx.closePath();
              ctx.stroke();
            }
          }
        }
      }
    }
	}
}

function process(){
  stats.begin()
  handleCamera()
  handleShapes()
  handleModels()
  clearScreen()
  drawFloorAndCeiling()
  drawShapes()
  drawModels()
  drawScore()
  t+=1/60;
  stats.end();
  requestAnimationFrame(process);
}


function loadScene(){
  shapes=[]
  terrain=[]
  stats = new Stats();
  stats.showPanel( 1 ); // 0: fps, 1: ms, 2: mb, 3+: custom
  document.body.appendChild( stats.dom );
  for(let i=0;i<cubeCount;++i){
    shapes.push(new Cube(
      ng.nextFloatRange(-fieldRadius, fieldRadius),
      ng.nextFloatRange(ceiling, floor), //floor-1-Math.random()*(floor-ceiling-2),
      ng.nextFloatRange(-fieldRadius, fieldRadius),
      1,  //1+Math.random()-.5, //scale
      cubeColors[ng.nextIntRange(0,cubeColors.length)]
    ))
  }

  for(let i=0;i<1000;++i){
    terrain.push(new Cube(
      ng.nextFloatRange(-fieldRadius, fieldRadius)|0,
      1,
      ng.nextFloatRange(-fieldRadius, fieldRadius)|0,
      ng.nextFloatRange(0, floor-ceiling),
      '#248'
    ))
  }
}


onkeydown=function(e){
  switch(e.which){
    case 16:shiftkey=1;break;
    case 32:spacekey=1;break;
    case 37:leftkey=1;break;
    case 38:upkey=1;break;
    case 39:rightkey=1;break;
    case 40:downkey=1;break;
    case 17:ctrlkey=1;break;
    case 87:wkey=1;break;
    case 65:akey=1;break;
    case 83:skey=1;break;
    case 68:dkey=1;break;
    case 72:hkey=1;break;
    case 67:ckey=1;showCeiling=!showCeiling;break;
    case 70:fkey=1;showFloor=!showFloor;break;
  }
}


onkeyup=function(e){
  switch(e.which){
    case 16:shiftkey=0;break;
    case 32:spacekey=0;break;
    case 37:leftkey=0;break;
    case 38:upkey=0;break;
    case 39:rightkey=0;break;
    case 40:downkey=0;break;
    case 17:ctrlkey=0;break;
    case 87:wkey=0;break;
    case 65:akey=0;break;
    case 83:skey=0;break;
    case 68:dkey=0;break;
    case 67:ckey=0;break;
    case 70:fkey=0;break;
    case 72:hkey=0;showHud = !showHud; break;
  }
}

canvas.requestPointerLock = canvas.requestPointerLock || canvas.mozRequestPointerLock || canvas.webkitRequestPointerLock
document.exitPointerLock = document.exitPointerLock || document.mozExitPointerLock || document.webkitExitPointerLock
c.onclick = function() {c.requestPointerLock()}
canvas.addEventListener("mousemove", mouse, true);
c.onmousedown=function(event){event.preventDefault();}
c.addEventListener("mousedown", function(event) {
  switch (event.which) {
    case 1: leftbutton=true; break;
    case 3: rightbutton=true; break;
  }
});
c.addEventListener("mouseup", function(event) {
  switch (event.which) {
    case 1: leftbutton=false; break;
    case 3: rightbutton=false; break;
  }
});

function mouse(e) {

	var movementX = e.movementX ||
		e.mozMovementX          ||
		e.webkitMovementX       ||
		0;

	var movementY = e.movementY ||
		e.mozMovementY      ||
		e.webkitMovementY   ||
		0;

	mx += movementX;
	my += movementY;
}


function Vertex(x,y,z){
	this.x=x; this.y=y; this.z=z;
}

function Polygon(){
	this.verts=new Array();
	this.dist=0;
}

function Model(x,y,z,pitch,yaw,roll){
	this.polys=new Array();
	this.x=x, this.y=y, this.z=z, this.pitch=pitch, this.yaw=yaw, this.roll=roll;
	this.dist=0;
	this.id=models.length;
}

models=new Array();

	// head
	size=.1;
	models.push(new Model(10,-2,0,Math.PI,Math.PI,0));
	verts=[[0,0,0],[-10.6232,28.7555,21.8388],[-11.6898,28.8712,22.2891],[-11.6898,27.6406,23.1481],[-10.6137,27.6102,22.6688],[-9.2302,28.0108,20.1793],[-9.0905,27.1840,20.6014],[-10.6779,32.8177,19.7150],[-11.6898,33.0057,20.0651],[-11.6898,30.5351,21.1924],[-10.5037,30.2955,20.7983],[-9.2198,31.9104,18.4873],[-9.1690,29.3783,19.5436],[-11.6898,26.2427,23.1945],[-10.6126,26.3707,22.7611],[-9.1319,26.3022,20.8828],[-11.6898,25.3697,22.5100],[-10.7431,25.5728,22.1647],[-9.4457,25.7517,20.9697],[-11.2796,25.2161,21.4542],[-11.6898,25.0761,21.4990],[-10.8289,24.9162,20.5299],[-11.6898,24.7069,20.7180],[-9.8151,25.6944,20.8876],[-10.5386,25.6791,21.5743],[-10.6936,25.3134,20.6306],[-10.9732,25.5134,21.3388],[-9.9094,25.9413,20.7969],[-10.3969,26.0189,21.3331],[-10.5776,25.7106,20.5968],[-10.7623,25.9119,21.2197],[-9.8039,26.4779,20.6652],[-10.3040,26.6114,21.3632],[-10.5102,26.2076,20.3382],[-10.6992,26.4864,21.2468],[-8.1958,26.9794,18.4956],[-7.5091,27.8642,18.3762],[-6.2167,30.3596,17.5717],[-4.9904,28.1286,17.3254],[-6.7669,26.8193,18.0307],[-5.4870,24.0825,17.1618],[-4.9247,22.7243,16.7777],[-3.1216,23.8047,14.8897],[-3.5667,25.1815,15.7041],[-7.9175,25.9723,18.3399],[-6.8544,23.3244,18.0224],[-6.2810,22.0556,17.8613],[-4.1879,26.6343,16.6281],[-6.0941,25.4951,17.5962],[-7.4074,24.7442,18.2079],[-2.8543,22.5141,14.2535],[-4.5203,21.4654,16.4377],[-5.9244,21.0322,17.6545],[-2.7228,20.5118,13.3979],[-5.0239,19.0156,16.5004],[-6.2606,19.4073,17.7660],[-7.0491,20.8130,17.9353],[-7.3006,20.5623,18.0952],[-6.9953,20.0354,18.0748],[-6.6214,20.9046,17.9196],[-7.0077,21.4686,18.3059],[-7.3208,21.0624,18.3892],[-9.1933,20.1340,19.7783],[-9.2064,19.2327,19.4976],[-9.5773,22.0273,20.5917],[-9.7251,22.7075,20.4468],[-11.6904,22.4580,20.8104],[-11.6898,21.8278,21.1032],[-7.7301,21.5105,19.1514],[-7.6609,22.2964,18.9637],[-11.6898,19.0600,20.1998],[-11.6898,19.9709,20.5582],[-7.4239,20.8017,17.6720],[-7.6091,20.8368,17.8248],[-7.4546,20.7503,17.9992],[-7.2582,20.7976,17.8480],[-7.5298,20.8830,18.2671],[-7.7594,20.8128,18.0208],[-9.1176,20.7869,19.6399],[-9.1572,21.0931,19.3035],[-8.2056,20.9128,18.5996],[-7.9085,21.1287,18.9835],[-9.6602,21.4364,20.3908],[-9.7923,21.0794,19.8074],[-11.6898,20.7438,20.4351],[-11.6898,21.0916,20.1075],[-7.5112,20.8147,17.5329],[-7.7101,20.8440,17.6902],[-7.8972,20.8198,17.8290],[-8.4107,20.8897,18.3166],[-11.6898,21.3045,20.9474],[-11.6898,21.0186,20.3451],[-9.8745,21.0325,19.4476],[-8.1950,24.3925,18.7827],[-10.1421,23.9737,20.1414],[-11.6901,23.7560,20.4233],[-8.6872,25.6188,18.7854],[-8.2196,26.4100,18.6194],[-11.6898,13.6078,19.2308],[-8.3856,14.1075,18.2506],[-8.5136,16.3675,19.0385],[-11.6898,16.1618,20.0935],[-5.2877,16.2712,15.3702],[-2.7870,18.5509,12.4683],[-1.9012,19.8111,10.9283],[-2.0394,21.5740,11.9109],[-1.8408,18.2352,9.6166],[-3.0231,16.9036,11.0210],[-1.0334,21.5626,9.0081],[-1.2955,23.1884,9.9465],[-0.1667,23.3430,6.5754],[-0.1772,25.2364,7.0421],[-8.7215,55.2582,6.3260],[-11.6904,55.3732,6.4264],[-11.6926,53.0956,12.0807],[-8.7370,52.9517,11.8975],[0.0115,50.1334,4.5477],[-4.3851,54.1710,5.8150],[-4.5786,51.9673,10.9091],[-0.3813,49.2084,8.0486],[2.2848,32.7170,5.2195],[2.5236,36.8052,5.0302],[0.6183,37.3304,11.0003],[0.8239,31.8095,10.0335],[1.9053,31.1851,5.1524],[0.6120,29.7766,9.2378],[0.2942,28.2535,8.4529],[0.0111,27.0154,7.8030],[1.0328,28.5278,4.7830],[1.3529,29.7817,5.0123],[0.7888,26.6190,4.3858],[0.4762,24.2440,4.3205],[-8.6489,55.6685,0.1849],[-11.6891,55.7201,0.2516],[0.4878,50.3372,-0.0693],[-4.1818,54.3475,0.0198],[-8.4373,53.4521,-7.8011],[-11.6906,53.6592,-7.9130],[0.8989,49.1058,-5.7327],[-3.5975,52.0921,-7.1438],[0.2492,42.7976,10.9791],[2.4496,41.8202,4.4797],[1.8265,46.0850,4.2169],[-0.0264,46.9291,9.6491],[3.2116,41.4061,-0.0094],[2.6141,46.0532,-0.0888],[2.8663,36.2006,1.5002],[2.5635,41.2949,-6.6939],[2.0930,45.9924,-6.2760],[2.3061,36.7280,-6.4785],[-0.1868,25.4340,-7.1663],[0.6065,29.8944,-9.4024],[2.0242,30.4476,-5.6050],[1.2632,28.0037,-4.6956],[1.4064,27.4397,-0.9398],[2.6332,28.1933,-0.5495],[2.3270,27.8723,0.7018],[0.9360,26.8611,0.6539],[2.9535,29.1039,-1.6296],[1.9554,28.6992,-2.2192],[2.6600,30.6703,-3.4131],[3.7759,30.7767,-2.7929],[3.9509,35.7771,0.8527],[4.2465,36.2356,0.2862],[3.4499,36.8295,-0.0797],[3.2312,36.3951,0.2697],[4.6069,36.6085,-0.5916],[3.6343,36.9779,-1.0282],[4.9178,36.6668,-1.7245],[3.8781,36.9513,-2.2483],[5.0550,36.3376,-2.5945],[4.0473,36.5801,-3.2297],[5.0393,35.7436,-2.9733],[4.0993,36.0079,-3.6748],[1.4499,28.1999,-3.2397],[0.8669,26.1468,-2.0819],[2.1503,30.6854,-3.8366],[1.3017,33.6586,-10.0674],[2.7205,33.1201,-5.7861],[2.7674,32.7118,-4.2211],[3.4081,32.4744,-4.1924],[2.9896,35.9287,0.4519],[2.9266,35.8809,-1.1931],[2.8568,35.6544,-1.7772],[2.7411,35.4827,0.5078],[3.0728,36.1568,-1.3039],[3.1646,35.9814,-2.2516],[3.3087,35.7586,-2.9720],[3.0275,35.3910,-2.9543],[3.4155,35.5974,-3.2891],[3.2647,35.2130,-3.3869],[4.0550,35.3173,-3.9037],[4.4997,32.4008,-3.4057],[5.0132,35.0685,-3.1956],[3.5066,31.0806,-2.3632],[2.7588,29.6501,-1.2356],[2.4420,29.1538,-0.4659],[2.2790,29.0872,0.2900],[2.2207,30.0931,1.2921],[1.6902,29.7734,1.9967],[1.6794,28.2913,1.6880],[2.0977,29.4804,0.9703],[2.4962,30.7866,1.3255],[1.9798,30.6864,2.1096],[2.5241,30.4568,-1.2391],[3.1259,31.3121,-1.8377],[2.8196,31.2147,-1.9414],[2.4833,30.5514,-1.5459],[2.2813,30.3894,-1.6138],[2.1091,30.4201,-1.3754],[2.1420,30.2234,-1.1034],[2.2719,30.2570,-1.3735],[1.9243,30.5500,-0.8824],[1.9848,30.2782,-0.6092],[-0.0585,29.9755,-0.2027],[-0.3357,30.4448,-1.2500],[-0.3999,31.6039,-1.0796],[0.0032,30.8789,0.3454],[0.0944,31.8180,0.0863],[2.6140,31.6349,1.1239],[2.2081,31.7380,2.0723],[4.0340,32.4830,-2.9784],[3.2173,32.1584,-2.3815],[3.6018,32.2911,-2.3413],[2.9079,32.0121,-2.3040],[2.6304,31.9006,-1.9163],[2.2602,31.0590,-1.7151],[2.5026,31.0583,-1.9935],[2.4609,31.9025,-1.3267],[2.0745,31.1822,-1.1309],[2.5088,32.1320,-0.4435],[2.7531,32.6717,1.0362],[2.0716,31.3957,-0.2680],[2.3283,32.7984,2.0051],[4.8613,33.8790,-3.3913],[4.2588,33.7089,-2.9727],[3.7901,33.1927,-2.3179],[3.4215,33.0346,-2.3732],[3.0236,32.8338,-2.3484],[2.7056,32.6584,-1.9883],[2.5339,32.6138,-1.4700],[2.5146,32.7552,-0.7600],[2.6354,33.1046,-0.0304],[4.4315,35.1870,-2.5527],[4.3722,34.6953,-2.7437],[3.4534,34.8300,0.4571],[3.4239,34.8098,-0.1587],[3.8321,35.4309,-0.2521],[3.6688,35.2204,0.2490],[3.3127,34.4388,1.3706],[3.2077,34.2852,0.5600],[3.6577,35.1899,1.2162],[4.4704,35.5781,-2.2545],[4.3201,35.8052,-1.7371],[4.0946,35.7460,-0.9232],[1.9897,31.6158,3.1370],[1.6458,30.4026,3.1463],[2.5777,35.3332,0.6143],[2.6508,35.7564,-2.0150],[2.8610,34.9940,-4.1459],[3.0211,34.2295,-3.8116],[3.8442,34.0704,-4.1494],[3.8396,33.9095,-2.0975],[3.5461,33.7519,-1.9747],[3.3440,33.8340,-1.6299],[2.9724,33.4351,-1.8086],[3.0240,33.3224,-2.1118],[2.8685,33.6643,0.4336],[2.9794,33.6340,1.2917],[2.5613,30.1026,-0.5259],[2.4227,30.0715,-0.0657],[2.7825,30.3263,-0.9953],[3.4712,31.2754,-1.8462],[4.0227,32.3794,-2.4142],[4.1725,33.3734,-2.4027],[4.1739,34.3558,-2.1675],[3.8570,34.4272,-1.8341],[3.6358,34.4302,-1.4313],[2.3301,30.2894,-0.8075],[2.1917,30.2693,-0.3376],[1.7569,30.6980,-0.3673],[1.8429,30.4069,-0.1111],[2.8649,33.6699,-0.8648],[2.5991,33.2968,-0.9165],[2.6395,33.1933,-1.4757],[2.9149,33.5510,-1.3696],[3.2255,33.9303,-1.2099],[2.9758,33.9187,-0.5045],[3.4825,34.4373,-0.9708],[3.2436,34.3928,-0.2539],[2.0619,30.3952,0.1476],[1.4020,30.7538,-0.0783],[1.5797,30.5255,0.2744],[1.8142,30.7523,0.5989],[1.7574,31.1934,0.5392],[1.4941,31.1427,0.0623],[0.5282,30.5838,-0.3240],[0.8615,30.1889,0.4944],[1.0926,30.7409,1.0520],[1.0421,31.4623,0.6811],[0.5255,31.3718,-0.2199],[2.6056,33.4493,-0.4149],[2.3147,30.2429,0.3915],[0.6337,24.8601,2.5408],[1.1099,27.3993,2.1316],[1.3776,29.3159,3.0166],[2.7693,33.1766,-1.9136],[2.3632,32.8452,3.1103],[-8.3182,48.8202,-13.8098],[-11.6900,49.0132,-14.0179],[-3.4402,47.5308,-12.0170],[-8.4546,42.5053,-16.6003],[-11.6911,42.6907,-16.8892],[-3.5616,41.8589,-14.4741],[-8.5173,36.8603,-17.7786],[-11.6897,36.9659,-17.9259],[-3.7134,36.5915,-15.7598],[-8.6055,33.6445,-17.6830],[-11.6891,33.6950,-17.8628],[-3.8879,33.5823,-15.8535],[-8.7595,28.8657,-16.4736],[-11.6904,28.8453,-16.6620],[-4.2056,29.1268,-14.7244],[-8.7478,23.5198,-14.4357],[-11.6893,23.4480,-14.5503],[-4.4981,23.9147,-12.8283],[0.1440,22.5698,3.0598],[0.0625,22.2985,4.7535],[-1.7208,17.6077,4.5818],[-0.8815,18.3042,1.6900],[-0.0421,23.1575,0.9851],[0.4021,23.6838,-1.6242],[-0.2032,18.4984,-0.5317],[-0.3579,18.5840,-4.2431],[-0.2124,23.4865,-5.4129],[-2.2577,12.5934,2.8156],[-3.6546,8.0946,4.2901],[-2.1021,8.3860,3.0601],[-1.1100,12.7794,1.1462],[1.2135,9.0813,-0.5639],[0.1499,13.0196,-2.5626],[-5.1252,7.7086,5.1722],[-3.3236,14.0882,5.1455],[-8.5277,17.9726,-13.4591],[-11.6898,17.8922,-13.5514],[-1.2847,18.5977,-8.2649],[-4.0808,18.3338,-11.7896],[-11.6894,12.1458,-13.6592],[-8.0365,12.3104,-13.4991],[-7.4076,8.5010,-14.2819],[-11.6907,8.2973,-14.1978],[0.6484,13.1051,-7.4204],[4.1497,9.7592,-6.4406],[-0.2424,9.3576,-12.2545],[-2.6433,12.8379,-11.7333],[-11.6898,11.6218,12.3273],[-11.6898,9.1071,10.5327],[-9.3128,9.5276,9.4235],[-9.2157,12.1989,11.8604],[-9.4096,6.6864,8.3219],[-11.6898,6.0207,9.3184],[-11.6898,4.5534,8.7148],[-8.9524,5.6199,7.5063],[-7.1120,10.7319,7.7178],[0.3653,25.3801,0.6537],[-0.8525,19.2519,6.2393],[-3.7966,15.6788,9.0304],[-4.9804,12.3754,6.3805],[-2.3595,16.9975,7.9139],[-6.4568,7.1657,5.9162],[-6.4912,13.7096,10.6360],[-0.7924,20.2577,7.8348],[-0.2115,22.1835,6.5817],[-5.7559,14.7920,13.3188],[-8.7720,12.9837,15.2192],[-11.6898,12.4517,15.7994],[-4.5644,4.9982,5.2979],[-2.9344,5.1978,4.4558],[2.1879,6.1891,1.0444],[-6.0207,4.8002,5.8760],[-6.9229,5.8402,-15.1203],[-11.6896,5.6076,-14.7539],[7.4776,7.4143,-5.7576],[1.9188,6.9119,-12.8512],[-9.1617,3.9873,7.3003],[-11.6900,3.6093,8.2511],[-7.1322,4.5887,6.2835],[-9.0104,17.9440,19.0929],[-11.6898,17.8992,19.8054],[-8.1094,34.2782,16.8079],[-8.2864,34.5891,17.6024],[-9.1955,33.6285,17.2107],[-8.7122,33.5240,16.7199],[-6.3961,31.7190,17.1387],[-6.4689,32.5022,16.9502],[-8.1369,32.9798,16.7945],[-8.3347,32.5093,17.1824],[-5.1106,32.4109,16.6926],[-5.0091,31.6045,16.6575],[-3.5009,32.9260,15.8643],[-3.2836,32.2626,15.6626],[-2.2097,33.4430,14.3896],[-2.5977,33.7215,14.7332],[-2.4004,34.6481,15.5863],[-2.7818,34.5454,15.4649],[-5.0348,35.3996,17.4426],[-5.2426,35.2751,16.8326],[-7.9261,33.9995,16.6487],[-8.3607,33.4680,16.5021],[-6.4746,33.2031,16.8126],[-7.9358,33.3835,16.5751],[-5.1738,33.1122,16.6668],[-2.9153,33.9354,14.9735],[-3.6707,33.4740,15.9118],[-5.2801,34.9083,16.7921],[-3.0672,34.3707,15.5519],[-8.0605,33.5825,16.2903],[-7.9185,33.8913,16.3938],[-6.5246,33.2820,16.4073],[-7.9173,33.4297,16.3195],[-5.3119,33.2089,16.1835],[-2.9810,33.9903,14.9912],[-3.7369,33.5823,15.7611],[-3.2101,34.3482,15.4541],[-5.3679,34.8393,16.4402],[-6.5817,33.2017,16.1920],[-7.5644,33.4723,16.1359],[-5.3820,33.1081,15.9471],[-2.9866,33.9821,14.9689],[-3.8441,33.5105,15.5354],[-3.2616,34.3791,15.3398],[-5.4330,34.9320,16.2348],[-7.5370,34.2126,16.2843],[-7.7813,33.7551,16.1639],[-8.6498,35.3661,18.9282],[-9.8563,33.8808,18.3696],[-4.5938,30.4640,16.8720],[-2.7602,31.3275,15.4065],[-1.4623,32.9672,13.9492],[-1.5116,35.4123,15.7952],[-4.6891,36.6165,18.6468],[-10.7368,34.1383,19.4467],[-9.6534,37.2257,19.8597],[-4.5769,38.8069,18.6285],[-0.6805,36.6620,14.6280],[-11.6898,34.2043,19.7406],[-11.6898,37.3483,19.9844],[-4.5479,40.5281,17.8390],[-4.4813,43.9733,16.6354],[-8.8118,44.1256,18.2865],[-8.8385,40.2640,19.2955],[-11.6906,44.1516,18.6223],[-11.6898,40.1644,19.4810],[-8.6887,49.1208,15.9004],[-4.5102,48.4975,14.2729],[-11.6845,49.3418,16.2393],[-0.4877,32.1756,13.1438],[-1.8946,29.9086,15.0271],[-3.7225,28.7435,16.6423],[-3.0516,27.2754,15.8454],[-2.6190,25.8300,14.7413],[-2.3583,24.5313,13.7565],[-2.2274,23.3524,12.9350],[-1.4365,28.5859,14.1701],[-1.3203,27.1376,12.9944],[-1.3186,25.9108,11.9187],[-1.3693,24.8168,11.0254],[-11.6898,21.0411,20.0206],[-9.2819,21.0588,19.0392],[-11.6898,21.0590,19.8504],[-9.7870,27.1017,20.3156],[-10.2449,27.2129,21.0930],[-10.3234,27.0149,19.9877],[-10.6601,27.1663,20.9751],[-12.7564,28.7555,21.8388],[-12.7659,27.6102,22.6688],[-14.1494,28.0108,20.1793],[-14.2891,27.1840,20.6014],[-12.7017,32.8177,19.7150],[-12.8759,30.2955,20.7983],[-14.1597,31.9104,18.4873],[-14.2106,29.3783,19.5436],[-12.7670,26.3706,22.7611],[-14.2477,26.3022,20.8828],[-12.6365,25.5728,22.1647],[-13.9339,25.7517,20.9696],[-12.1000,25.2161,21.4542],[-12.5507,24.9162,20.5299],[-13.5645,25.6944,20.8876],[-12.8409,25.6791,21.5743],[-12.6860,25.3134,20.6306],[-12.4063,25.5134,21.3388],[-13.4702,25.9413,20.7969],[-12.9827,26.0189,21.3331],[-12.8020,25.7106,20.5968],[-12.6173,25.9119,21.2197],[-13.5757,26.4779,20.6652],[-13.0755,26.6115,21.3632],[-12.8694,26.2076,20.3382],[-12.6803,26.4865,21.2468],[-15.8705,27.8642,18.3762],[-15.1837,26.9794,18.4955],[-17.9744,30.4118,17.2218],[-19.0231,28.4360,16.9839],[-16.6127,26.8193,18.0307],[-20.6396,24.1680,14.3231],[-18.4549,22.7243,16.7777],[-17.8926,24.0825,17.1618],[-20.2868,25.5058,15.2227],[-15.4621,25.9723,18.3400],[-17.0986,22.0556,17.8614],[-16.5252,23.3244,18.0224],[-17.2855,25.4951,17.5962],[-19.7599,26.9549,16.2368],[-15.9722,24.7442,18.2079],[-20.8387,22.9333,13.5942],[-18.8593,21.4654,16.4377],[-17.4552,21.0322,17.6545],[-20.9985,21.0429,12.6544],[-18.3557,19.0156,16.5004],[-17.1190,19.4073,17.7660],[-16.3843,20.0354,18.0748],[-16.0790,20.5623,18.0952],[-16.3305,20.8130,17.9354],[-16.7582,20.9046,17.9197],[-16.3719,21.4686,18.3059],[-16.0588,21.0624,18.3891],[-14.1731,19.2327,19.4976],[-14.1863,20.1340,19.7783],[-13.6545,22.7075,20.4468],[-13.8023,22.0273,20.5917],[-15.6495,21.5105,19.1515],[-15.7187,22.2964,18.9637],[-15.9249,20.7503,17.9992],[-15.7704,20.8366,17.8248],[-15.9558,20.8018,17.6720],[-16.1215,20.7976,17.8479],[-15.6202,20.8132,18.0208],[-15.8498,20.8830,18.2672],[-14.2620,20.7869,19.6398],[-14.2224,21.0931,19.3035],[-13.7194,21.4364,20.3908],[-15.4710,21.1287,18.9835],[-15.1741,20.9126,18.5996],[-13.5873,21.0794,19.8075],[-15.6694,20.8433,17.6903],[-15.8684,20.8155,17.5330],[-15.4824,20.8184,17.8292],[-14.9689,20.8915,18.3163],[-13.5051,21.0335,19.4476],[-15.1846,24.3925,18.7827],[-13.2376,23.9737,20.1414],[-14.6924,25.6188,18.7854],[-15.1600,26.4101,18.6196],[-14.8660,16.3675,19.0385],[-14.9940,14.1075,18.2506],[-21.0355,19.1810,11.6983],[-18.0919,16.2712,15.3702],[-14.6076,12.9837,15.2192],[-17.6237,14.7920,13.3188],[-20.9477,17.5694,10.3188],[-22.0841,23.1884,9.9465],[-22.3462,21.5626,9.0081],[-22.5872,20.2577,7.8348],[-23.2024,25.2364,7.0421],[-23.2129,23.3430,6.5754],[-23.1681,22.1834,6.5817],[-14.6581,55.2582,6.3260],[-14.6437,52.9556,11.9015],[-18.8091,51.9844,10.9216],[-18.9945,54.1710,5.8150],[-23.3911,50.1334,4.5477],[-22.9983,49.2084,8.0486],[-23.9978,37.3304,11.0003],[-25.9032,36.8052,5.0302],[-25.6644,32.7171,5.2195],[-24.2035,31.8095,10.0335],[-25.2849,31.1851,5.1524],[-23.9916,29.7766,9.2378],[-24.4124,28.5278,4.7830],[-23.3907,27.0154,7.8030],[-23.6738,28.2535,8.4529],[-24.7325,29.7817,5.0123],[-24.1684,26.6190,4.3858],[-23.8558,24.2440,4.3205],[-23.4420,22.2985,4.7535],[-14.7307,55.6685,0.1849],[-19.1978,54.3475,0.0198],[-23.8674,50.3372,-0.0693],[-14.9423,53.4521,-7.8011],[-19.7821,52.0921,-7.1438],[-24.2785,49.1058,-5.7327],[-23.6288,42.7976,10.9791],[-25.8292,41.8202,4.4797],[-25.2061,46.0850,4.2169],[-23.3532,46.9291,9.6491],[-25.9937,46.0532,-0.0888],[-26.5912,41.4061,-0.0094],[-26.2459,36.2006,1.5002],[-25.4726,45.9924,-6.2760],[-25.9431,41.2949,-6.6939],[-25.6857,36.7280,-6.4785],[-25.4038,30.4476,-5.6050],[-23.9860,29.8944,-9.4024],[-23.1928,25.4340,-7.1663],[-24.6428,28.0036,-4.6956],[-25.3828,28.0818,1.1949],[-26.0128,28.1933,-0.5495],[-24.7860,27.4397,-0.9398],[-24.4760,27.2852,1.6494],[-26.3331,29.1039,-1.6296],[-25.3350,28.6992,-2.2192],[-27.1555,30.7767,-2.7929],[-26.0396,30.6703,-3.4131],[-26.8294,36.8295,-0.0797],[-27.6261,36.2355,0.2862],[-27.0201,35.1352,1.1465],[-26.3669,35.9355,0.4098],[-27.1358,36.9646,-1.6383],[-28.1420,36.6376,-1.1581],[-27.4269,36.5801,-3.2297],[-28.4346,36.3376,-2.5945],[-27.4567,35.6626,-3.7892],[-28.4059,35.4061,-3.0845],[-24.8294,28.1999,-3.2397],[-24.2465,26.1468,-2.0819],[-25.5299,30.6854,-3.8366],[-24.6813,33.6586,-10.0674],[-26.1001,33.1201,-5.7861],[-26.1470,32.7118,-4.2211],[-26.7877,32.4744,-4.1924],[-26.3848,35.9184,-1.6314],[-26.5477,35.5748,-2.9631],[-26.7197,35.4052,-3.3380],[-27.8793,32.4008,-3.4057],[-26.1384,29.6501,-1.2356],[-26.8862,31.0806,-2.3632],[-25.8216,29.1538,-0.4659],[-25.5679,29.2838,0.6302],[-25.0698,29.7734,1.9967],[-25.6003,30.0931,1.2921],[-25.8758,30.7866,1.3254],[-25.3594,30.6864,2.1096],[-26.1992,31.2147,-1.9414],[-26.5055,31.3121,-1.8377],[-25.9037,30.4568,-1.2391],[-25.8629,30.5514,-1.5459],[-25.5215,30.2234,-1.1034],[-25.4887,30.4201,-1.3754],[-25.6609,30.3894,-1.6138],[-25.6516,30.2571,-1.3735],[-25.2934,30.3425,-0.3602],[-25.2202,30.6240,-0.6248],[-22.9796,31.6038,-1.0793],[-23.0437,30.4444,-1.2501],[-23.3212,29.9756,-0.2031],[-23.3828,30.8790,0.3453],[-23.4740,31.8181,0.0862],[-25.5877,31.7380,2.0723],[-25.9936,31.6349,1.1239],[-27.4136,32.4830,-2.9784],[-26.5969,32.1584,-2.3815],[-26.9814,32.2911,-2.3413],[-25.6398,31.0590,-1.7151],[-26.0100,31.9007,-1.9163],[-26.2875,32.0121,-2.3040],[-25.8822,31.0583,-1.9935],[-25.4526,31.2889,-0.6994],[-25.8644,32.0172,-0.8851],[-26.1327,32.6717,1.0362],[-25.7079,32.7984,2.0051],[-27.6384,33.7089,-2.9727],[-28.2409,33.8790,-3.3913],[-26.8011,33.0346,-2.3732],[-27.1697,33.1927,-2.3180],[-26.0852,32.6584,-1.9883],[-26.4032,32.8338,-2.3483],[-25.9038,32.6845,-1.1150],[-26.0150,33.1046,-0.0304],[-27.8366,35.4878,-2.2527],[-27.7814,34.9412,-2.6482],[-27.5574,35.6816,-1.3493],[-27.0984,35.1963,-0.2150],[-25.0254,30.4026,3.1463],[-25.3693,31.6158,3.1370],[-26.0304,35.7564,-2.0150],[-25.9573,35.3332,0.6143],[-26.2406,34.9940,-4.1459],[-26.4007,34.2295,-3.8116],[-27.2238,34.0703,-4.1494],[-27.2192,33.9096,-2.0975],[-26.8247,33.7929,-1.8023],[-26.8229,34.7786,0.4220],[-26.2481,33.6643,0.4336],[-26.3590,33.6340,1.2917],[-25.7483,30.1572,0.1629],[-25.9409,30.1026,-0.5259],[-26.1621,30.3263,-0.9953],[-26.8508,31.2754,-1.8462],[-27.4023,32.3794,-2.4142],[-27.5521,33.3734,-2.4027],[-25.7096,30.2894,-0.8075],[-25.5064,30.3322,-0.0950],[-26.3778,33.3788,-1.9602],[-26.3820,33.8986,-0.6230],[-24.9593,30.5255,0.2744],[-24.7816,30.7538,-0.0783],[-25.1938,30.7523,0.5989],[-25.1370,31.1934,0.5391],[-24.8737,31.1427,0.0623],[-24.2411,30.1889,0.4944],[-23.9078,30.5839,-0.3239],[-24.4722,30.7409,1.0520],[-24.4217,31.4623,0.6812],[-23.9052,31.3719,-0.2200],[-26.2695,33.6104,-1.1172],[-25.9851,33.4493,-0.4149],[-25.9989,33.2450,-1.1961],[-23.8791,25.1201,1.5972],[-24.7572,29.3159,3.0166],[-26.1489,33.1766,-1.9136],[-25.7428,32.8452,3.1103],[-15.0614,48.8202,-13.8099],[-19.9394,47.5308,-12.0170],[-14.9250,42.5054,-16.6003],[-19.8180,41.8589,-14.4741],[-14.8623,36.8603,-17.7785],[-19.6662,36.5915,-15.7598],[-14.7741,33.6445,-17.6830],[-19.4917,33.5823,-15.8535],[-14.6201,28.8657,-16.4736],[-19.1740,29.1268,-14.7244],[-14.6317,23.5198,-14.4357],[-18.8814,23.9147,-12.8283],[-23.1672,23.4866,-5.4129],[-23.7817,23.6838,-1.6242],[-23.0217,18.5840,-4.2431],[-23.1764,18.4984,-0.5317],[-21.2775,8.3860,3.0601],[-17.9564,7.5337,5.3239],[-19.4941,12.8581,5.1805],[-22.2697,12.7795,1.1462],[-24.5929,9.0810,-0.5642],[-23.5295,13.0197,-2.5625],[-14.8519,17.9726,-13.4591],[-22.0949,18.5977,-8.2649],[-19.2988,18.3338,-11.7896],[-15.9720,8.5005,-14.2809],[-15.3431,12.3105,-13.4992],[-24.0281,13.1052,-7.4204],[-27.5293,9.7583,-6.4406],[-23.1371,9.3570,-12.2541],[-20.7363,12.8380,-11.7334],[-14.0668,9.5276,9.4235],[-14.1639,12.1989,11.8604],[-13.9700,6.6864,8.3218],[-14.4272,5.6199,7.5063],[-16.2676,10.7319,7.7178],[-23.4306,22.8636,2.0224],[-22.0784,17.9559,3.1359],[-22.5271,19.2519,6.2393],[-20.3015,16.3381,8.4722],[-16.8884,13.7096,10.6360],[-20.4450,5.1979,4.4561],[-17.1667,4.7439,5.9349],[-25.5665,6.1869,1.0437],[-16.4567,5.8434,-15.1274],[-30.8568,7.4145,-5.7577],[-25.2985,6.9143,-12.8545],[-14.2179,3.9874,7.3001],[-14.3692,17.9440,19.0929],[-14.1840,33.6285,17.2107],[-15.0932,34.5891,17.6023],[-15.2702,34.2782,16.8079],[-14.6674,33.5240,16.7199],[-15.2427,32.9798,16.7945],[-17.5898,32.4565,16.8214],[-17.6770,31.6617,16.8981],[-15.0448,32.5093,17.1824],[-21.1699,33.4430,14.3896],[-20.0960,32.2626,15.6626],[-19.8787,32.9260,15.8643],[-20.7819,33.7215,14.7332],[-20.9792,34.6481,15.5863],[-20.5978,34.5454,15.4649],[-18.1370,35.2751,16.8326],[-18.3448,35.3996,17.4426],[-15.4535,33.9996,16.6487],[-15.0189,33.4680,16.5021],[-15.4438,33.3835,16.5751],[-17.5554,33.1576,16.7397],[-19.7089,33.4740,15.9118],[-20.4643,33.9354,14.9735],[-20.3124,34.3708,15.5519],[-18.0995,34.9083,16.7921],[-15.3192,33.5825,16.2901],[-15.4612,33.8913,16.3938],[-15.4623,33.4296,16.3196],[-17.4613,33.2455,16.2953],[-19.6427,33.5823,15.7611],[-20.3988,33.9908,14.9917],[-20.1694,34.3481,15.4537],[-18.0117,34.8393,16.4400],[-17.3978,33.1543,16.0707],[-15.8158,33.4729,16.1353],[-20.3946,33.9835,14.9712],[-19.5352,33.5109,15.5348],[-20.1185,34.3789,15.3394],[-17.9468,34.9318,16.2353],[-15.8421,34.2131,16.2857],[-15.5976,33.7548,16.1644],[-14.7298,35.3661,18.9282],[-13.5233,33.8808,18.3696],[-20.6194,31.3275,15.4065],[-21.9173,32.9672,13.9492],[-21.8680,35.4123,15.7952],[-18.6905,36.6165,18.6468],[-12.6428,34.1383,19.4467],[-13.7262,37.2257,19.8597],[-18.8027,38.8069,18.6285],[-22.6991,36.6620,14.6280],[-14.5680,44.1258,18.2886],[-18.8979,43.9730,16.6346],[-18.8313,40.5277,17.8379],[-14.5411,40.2640,19.2955],[-14.6784,49.1234,15.9470],[-18.8959,48.5455,14.3421],[-22.8919,32.1756,13.1438],[-21.4850,29.9086,15.0271],[-21.9430,28.5859,14.1701],[-22.0593,27.1376,12.9944],[-22.0610,25.9108,11.9187],[-22.0103,24.8168,11.0254],[-14.0975,21.0577,19.0390],[-13.5926,27.1017,20.3155],[-13.1348,27.2129,21.0932],[-13.0562,27.0149,19.9878],[-12.7195,27.1663,20.9751]];
	faces=[[1,2,3,4],[5,1,4,6],[7,8,9,10],[11,7,10,12],[4,3,13,14],[4,14,15,6],[13,16,17,14],[14,17,18,15],[19,17,16,20],[21,19,20,22],[23,18,17,24],[25,21,18,23],[17,19,26,24],[19,21,25,26],[27,23,24,28],[29,25,23,27],[28,24,26,30],[26,25,29,30],[31,27,28,32],[33,29,27,31],[32,28,30,34],[34,30,29,33],[9,2,1,10],[10,1,5,12],[5,35,36,12],[12,36,37,11],[38,37,36,39],[40,41,42,43],[39,36,35,44],[45,46,41,40],[43,47,48,40],[40,48,49,45],[50,42,41,51],[51,41,46,52],[53,50,51,54],[54,51,52,55],[56,57,58,59],[56,59,60,61],[57,62,63,58],[64,65,66,67],[68,61,60,69],[70,63,62,71],[72,73,74,75],[76,77,72,75],[78,74,73,79],[80,81,82,83],[80,77,76,81],[84,78,79,85],[86,87,73,72],[77,88,86,72],[80,89,88,77],[82,64,67,90],[76,61,68,81],[75,56,61,76],[74,57,56,75],[74,78,62,57],[83,82,90,91],[68,69,65,64],[89,80,83,92],[81,68,64,82],[71,62,78,84],[58,55,52,59],[60,59,52,46],[69,60,46,45],[45,49,93,69],[69,93,94,65],[66,65,94,95],[96,93,49,44],[94,93,96,21],[22,95,94,21],[44,49,48,39],[39,48,47,38],[96,15,18,21],[97,96,44,35],[98,99,100,101],[102,103,53,54],[103,104,105,53],[106,104,103,107],[108,109,105,104],[110,111,109,108],[112,113,114,115],[116,117,118,119],[120,121,122,123],[124,120,123,125],[126,127,128,129],[130,128,127,111],[131,130,111,110],[132,133,113,112],[116,134,135,117],[132,136,137,133],[138,139,135,134],[140,122,121,141],[140,141,142,143],[141,144,145,142],[121,146,144,141],[144,147,148,145],[146,149,147,144],[143,142,116,119],[145,134,116,142],[148,138,134,145],[150,151,152,153],[154,155,156,157],[158,155,154,159],[160,161,158,159],[162,163,164,165],[163,166,167,164],[166,168,169,167],[170,171,169,168],[170,172,173,171],[174,159,154,175],[174,176,160,159],[152,151,177,178],[178,179,176,152],[179,180,160,176],[181,182,183,184],[183,182,185,186],[187,188,183,186],[187,189,190,188],[173,191,190,189],[164,167,185,165],[167,169,186,185],[169,171,187,186],[171,173,189,187],[180,192,161,160],[173,172,193,191],[194,195,158,161],[195,196,155,158],[197,156,155,196],[198,199,200,201],[199,198,202,203],[204,205,206,207],[208,209,210,211],[209,212,213,210],[214,215,216,217],[218,217,216],[219,220,203,202],[192,221,194,161],[222,206,205,223],[224,225,226,227],[225,228,229,226],[230,231,219,232],[231,233,220,219],[192,234,235,221],[236,237,222,223],[238,239,225,224],[239,240,228,225],[241,242,231,230],[172,243,244,193],[245,246,247,248],[249,250,245,251],[172,170,252,243],[170,168,253,252],[168,166,254,253],[166,163,247,254],[248,162,251,245],[249,251,181,184],[162,165,181,251],[255,256,203,220],[146,257,258,149],[258,259,149],[260,259,188,190],[261,260,190,191],[234,261,191,193],[234,193,244,235],[237,236,262,263],[263,264,265,266],[267,250,249,268],[268,249,184,257],[196,269,270,197],[196,195,271,269],[195,194,272,271],[221,273,272,194],[221,235,274,273],[235,244,275,274],[252,275,244,243],[276,275,252,253],[253,254,277,276],[231,242,267,268],[257,233,231,268],[205,204,271,272],[204,278,269,271],[278,279,270,269],[213,212,280,281],[228,230,232,229],[230,228,240,241],[282,283,284,285],[262,236,274,275],[274,236,223,273],[205,272,273,223],[149,259,178,177],[260,179,178,259],[261,180,179,260],[192,180,261,234],[227,208,207,206],[211,210,278,204],[238,237,263,266],[238,224,222,237],[224,227,206,222],[286,287,282,285],[275,276,263,262],[276,277,264,263],[277,288,286,264],[289,287,286,288],[246,289,288,247],[210,213,279,278],[213,281,290,279],[232,280,212,229],[209,226,229,212],[209,208,227,226],[291,292,281,280],[293,290,281,292],[293,294,219,202],[294,295,232,219],[295,291,280,232],[296,297,292,291],[297,298,293,292],[298,299,294,293],[299,300,295,294],[300,296,291,295],[297,296,215,214],[299,298,217,218],[300,299,218,216],[296,300,216,215],[162,248,247,163],[289,246,245,250],[264,286,285,265],[283,301,242,241],[247,288,277,254],[150,153,174,175],[202,198,201,302],[204,207,208,211],[174,153,152,176],[130,131,303,304],[128,130,304,305],[285,284,306,265],[307,146,121,120],[302,270,279,290],[201,197,270,302],[200,156,197,201],[304,157,156,200],[137,136,308,309],[148,310,139,138],[309,308,311,312],[147,313,310,148],[312,311,314,315],[313,147,149,316],[315,314,317,318],[316,149,177,319],[318,317,320,321],[319,177,151,322],[321,320,323,324],[150,325,322,151],[326,303,131,327],[328,329,330,326],[331,332,333,334],[335,336,337,338],[338,337,339,340],[341,336,335,342],[324,323,343,344],[334,333,345,150],[150,345,346,325],[347,348,349,350],[351,340,339,352],[351,352,353,354],[355,356,357,358],[359,357,356,360],[360,361,362,359],[357,359,362,363],[364,175,154,157],[365,328,326,327],[366,367,342,368],[368,342,328,365],[362,369,367,363],[342,367,369,341],[363,367,366,370],[371,365,327,372],[365,371,106,368],[368,106,107,366],[107,373,370,366],[373,374,358,370],[358,374,375,355],[298,297,214,217],[330,329,332,331],[331,175,364,330],[303,364,157,304],[188,259,258,183],[258,257,184,183],[336,376,377,337],[337,377,378,339],[341,379,376,336],[350,349,380,381],[339,378,382,352],[352,382,383,353],[384,362,361,385],[362,384,386,369],[369,386,379,341],[128,305,256,129],[387,63,70,388],[6,15,96,97],[6,97,35,5],[55,58,63,387],[54,100,99,102],[389,390,391,392],[393,394,395,396],[397,394,393,398],[399,400,401,402],[402,401,403,404],[405,406,404,403],[390,389,406,405],[407,389,392,408],[394,409,410,395],[411,409,394,397],[412,413,399,402],[406,414,415,404],[407,414,406,389],[407,408,416,417],[409,418,419,410],[411,420,418,409],[412,421,422,413],[412,415,423,421],[414,424,423,415],[407,417,424,414],[392,391,396,395],[408,392,395,410],[400,399,397,398],[399,413,411,397],[413,422,420,411],[419,418,425,426],[418,420,427,425],[422,421,428,429],[423,430,428,421],[423,424,431,430],[424,417,432,431],[420,422,429,427],[433,432,417,416],[391,390,434,435],[393,396,11,37],[398,393,37,436],[401,400,437,438],[403,401,438,439],[405,403,439,440],[390,405,440,434],[396,391,435,11],[400,398,436,437],[441,7,11,435],[442,441,435,434],[443,442,434,440],[444,443,440,439],[445,8,7,441],[446,445,441,442],[447,448,449,450],[140,448,447,122],[450,449,451,452],[453,449,448,454],[454,448,140,143],[451,449,453,455],[118,454,143,119],[114,455,453,115],[439,438,456,444],[457,456,438,437],[458,457,437,436],[38,458,436,37],[458,38,47,459],[460,43,42,461],[459,47,43,460],[461,42,50,462],[50,53,105,462],[457,458,459,463],[464,460,461,465],[463,459,460,464],[465,461,462,466],[462,105,109,466],[456,457,463,123],[125,464,465,126],[123,463,464,125],[126,465,466,127],[466,109,111,127],[444,456,123,122],[404,415,412,402],[467,92,83,91],[329,328,342,335],[332,329,335,338],[333,332,338,340],[345,333,340,351],[346,345,351,354],[348,347,344,343],[125,126,129,124],[255,124,129,256],[453,454,118,115],[115,118,117,112],[112,117,135,132],[136,132,135,139],[370,358,357,363],[256,305,199,203],[307,120,124,255],[468,79,73,87],[85,79,468,469],[290,293,202,302],[284,283,241,240],[304,200,199,305],[284,240,239,306],[306,239,238,266],[266,265,306],[250,267,287,289],[287,267,242,301],[287,301,283,282],[54,55,387,100],[101,100,387,388],[136,139,310,308],[308,310,313,311],[311,313,316,314],[314,316,319,317],[317,319,322,320],[320,322,325,323],[323,325,346,343],[343,346,354,348],[348,354,353,349],[349,353,383,380],[470,31,32,471],[472,33,31,470],[471,32,34,473],[473,34,33,472],[471,473,472,470],[220,233,307,255],[146,307,233,257],[416,408,410,419],[416,419,426,433],[450,452,446,442],[447,450,442,443],[122,447,443,444],[182,181,165,185],[3,2,474,475],[475,474,476,477],[9,8,478,479],[479,478,480,481],[13,3,475,482],[483,482,475,477],[484,16,13,482],[485,484,482,483],[16,484,486,20],[20,486,487,22],[484,485,488,489],[485,487,490,488],[491,486,484,489],[490,487,486,491],[489,488,492,493],[488,490,494,492],[491,489,493,495],[494,490,491,495],[493,492,496,497],[492,494,498,496],[495,493,497,499],[494,495,499,498],[474,2,9,479],[476,474,479,481],[500,501,476,481],[502,500,481,480],[500,502,503,504],[505,506,507,508],[501,500,504,509],[506,510,511,507],[512,513,508,507],[514,512,507,511],[506,505,515,516],[510,506,516,517],[516,515,518,519],[517,516,519,520],[521,522,523,524],[525,524,523,526],[527,528,522,521],[66,529,530,67],[525,526,531,532],[528,527,70,71],[533,534,535,536],[535,537,538,536],[534,533,539,540],[541,542,543,544],[538,537,543,542],[540,539,84,85],[534,545,546,535],[546,547,537,535],[547,548,543,537],[67,530,541,90],[531,526,538,542],[526,523,536,538],[523,522,533,536],[528,539,533,522],[90,541,544,91],[529,532,531,530],[544,543,548,549],[530,531,542,541],[539,528,71,84],[517,520,521,524],[517,524,525,510],[510,525,532,511],[550,514,511,532],[551,550,532,529],[551,529,66,95],[514,550,552,509],[552,550,551,487],[551,95,22,487],[512,514,509,504],[513,512,504,503],[485,483,552,487],[553,501,509,552],[554,555,98,101],[518,556,557,519],[558,555,557,559],[375,98,555,558],[557,556,560,559],[518,561,562,556],[556,562,563,560],[561,564,565,562],[566,563,562,565],[114,113,567,568],[569,570,571,572],[573,574,575,576],[576,575,577,578],[579,580,581,582],[580,579,583,564],[564,583,584,565],[585,566,565,584],[113,133,586,567],[587,588,571,570],[137,589,586,133],[587,590,591,588],[574,573,592,593],[594,593,592,595],[596,597,593,594],[597,598,574,593],[599,600,597,596],[600,601,598,597],[571,594,595,572],[571,588,596,594],[588,591,599,596],[602,603,604,605],[606,607,608,609],[608,607,610,611],[610,612,613,611],[614,615,616,617],[618,619,615,614],[618,620,621,619],[622,623,621,620],[608,611,624,625],[613,626,624,611],[627,603,602,628],[626,629,628,602],[613,630,629,626],[631,618,614,617],[632,620,618,631],[633,622,620,632],[612,634,630,613],[610,635,636,612],[607,637,635,610],[607,606,638,637],[606,639,640,638],[641,640,639,642],[643,644,645,646],[647,648,649,650],[651,652,648,647],[653,654,655,656],[656,657,653],[642,658,659,641],[636,660,634,612],[644,643,661,662],[663,664,665,666],[667,668,664,663],[659,669,668,667],[658,670,669,659],[671,672,634,660],[661,673,674,662],[664,675,676,665],[668,677,675,664],[669,678,677,668],[679,621,623,680],[681,619,621,679],[682,615,619,681],[642,683,684,658],[685,686,598,601],[687,685,601],[632,687,688,633],[633,688,689,622],[622,689,672,623],[680,623,672,671],[690,674,673,691],[616,692,693,694],[617,616,694,686],[695,696,637,638],[697,635,637,696],[698,636,635,697],[698,699,660,636],[700,671,660,699],[679,680,671,700],[693,678,669,694],[669,670,686,694],[697,645,644,698],[696,701,645,697],[695,702,701,696],[700,674,690,679],[662,674,700,699],[699,698,644,662],[628,687,601,627],[628,629,688,687],[629,630,689,688],[689,630,634,672],[646,649,666,643],[701,647,650,645],[691,673,676,703],[661,665,676,673],[643,666,665,661],[691,681,679,690],[704,682,681,691],[702,651,647,701],[667,663,648,652],[666,649,648,663],[651,705,706,652],[651,702,707,705],[659,708,707,641],[667,709,708,659],[652,706,709,667],[705,710,711,706],[707,712,710,705],[708,713,712,707],[709,714,713,708],[706,711,714,709],[654,711,710,655],[656,712,713,657],[657,713,714,653],[653,714,711,654],[682,692,616,615],[715,704,691,703],[678,716,717,677],[624,605,604,625],[638,640,641,695],[649,646,645,650],[602,605,624,626],[718,584,583,609],[609,583,579,719],[720,717,715,703],[574,598,721,575],[722,589,137,309],[590,723,599,591],[724,722,309,312],[723,725,600,599],[726,724,312,315],[601,600,725,727],[728,726,315,318],[627,601,727,729],[730,728,318,321],[603,627,729,731],[732,730,321,324],[731,733,604,603],[625,604,734,735],[736,737,735,734],[738,739,740,741],[742,738,741,743],[744,732,324,344],[745,736,734,604],[746,745,604,733],[747,748,347,350],[742,743,749,750],[751,750,749,752],[753,356,355,754],[356,753,755,360],[756,361,360,755],[756,755,753,757],[608,625,718,609],[758,759,760,585],[759,740,761,760],[740,739,756,757],[761,740,757,762],[585,760,563,566],[560,563,760,761],[762,559,560,761],[754,558,559,762],[375,558,754,355],[655,710,712,656],[737,759,758,735],[685,687,632,631],[617,686,685,631],[763,764,739,738],[765,763,738,742],[766,747,350,381],[767,765,742,750],[768,767,750,751],[361,756,769,385],[764,769,756,739],[683,719,579,582],[70,527,770,388],[552,483,477,553],[501,553,477,476],[527,521,520,770],[555,554,519,557],[771,772,773,774],[775,776,777,778],[779,780,781,782],[783,779,782,784],[784,785,786,783],[785,773,772,786],[774,773,787,788],[789,790,776,775],[781,791,792,782],[793,794,785,784],[785,794,787,773],[795,788,787,796],[797,798,790,789],[799,800,792,791],[801,793,792,800],[801,802,794,793],[802,796,787,794],[778,771,774,775],[775,774,788,789],[776,781,780,777],[790,791,781,776],[798,799,791,790],[803,798,797,804],[805,800,799,806],[805,807,801,800],[808,802,801,807],[809,796,802,808],[806,799,798,803],[796,809,810,795],[811,772,771,812],[480,778,777,502],[813,780,779,814],[814,779,783,815],[815,783,786,816],[816,786,772,811],[812,771,778,480],[502,777,780,813],[480,478,817,812],[812,817,818,811],[811,818,819,816],[816,819,820,815],[478,8,445,817],[817,445,446,818],[821,822,823,824],[823,822,592,573],[451,821,824,452],[822,821,825,826],[592,822,826,595],[825,821,451,455],[595,826,569,572],[825,455,114,568],[827,814,815,820],[814,827,828,813],[813,828,503,502],[513,503,828,829],[505,508,830,831],[508,513,829,830],[515,505,831,832],[561,518,515,832],[829,828,827,576],[831,830,578,581],[830,829,576,578],[832,831,581,580],[564,561,832,580],[576,827,820,573],[792,793,784,782],[544,549,467,91],[740,759,737,741],[741,737,736,743],[743,736,745,749],[749,745,746,752],[344,347,748,744],[582,581,578,577],[582,577,684,683],[569,826,825,568],[570,569,568,567],[587,570,567,586],[587,586,589,590],[753,754,762,757],[639,719,683,642],[577,575,721,684],[534,540,833,545],[833,540,85,469],[641,707,702,695],[639,606,609,719],[675,677,717,720],[676,675,720,703],[704,693,692,682],[678,693,704,716],[717,716,704,715],[770,520,519,554],[770,554,101,388],[723,590,589,722],[725,723,722,724],[727,725,724,726],[729,727,726,728],[731,729,728,730],[733,731,730,732],[746,733,732,744],[752,746,744,748],[751,752,748,747],[768,751,747,766],[497,496,834,835],[496,498,836,834],[499,497,835,837],[498,499,837,836],[836,837,835,834],[721,670,658,684],[670,721,598,686],[789,788,795,797],[804,797,795,810],[446,452,824,818],[818,824,823,819],[819,823,573,820],[374,373,102,99],[375,374,99,98],[102,373,107,103],[104,106,371,108],[108,371,372,110],[110,372,327,131],[303,326,330,364],[175,331,334,150],[758,585,584,718],[735,758,718,625]];
	let X=Y=Z=0; for(i=1;i<verts.length;++i){ X+=verts[i][0]; Y+=verts[i][1]; Z+=verts[i][2]; } X/=verts.length-1; Y/=verts.length-1; Z/=verts.length-1;
	for(i=0;i<faces.length;++i){
		let p=new Polygon();
		for(j=0;j<faces[i].length;++j){
			p.verts.push(new Vertex((verts[faces[i][j]][0]-X)*size,(verts[faces[i][j]][1]-Y)*size,(verts[faces[i][j]][2]-Z+5)*size));
		}
		models[models.length-1].polys.push(p);
	}


ng = new LCG();
ng.setSeed(1019);
cubeCount=90
cubeColors=['#1f8','#18f']
fieldRadius=150
gridSegs=8
playerRotateSpeed=.025
playerSpeed=.1
playerCubeScore=0;
playerRadius = 5;
floor=1
ceiling=-6
showCeiling=1
showFloor=1
camVX=camVY=camVZ=camPitchV=camYawV=camPitch=0
camX=40
camY=0
camZ=25
camYaw=3.6
lineSubs=1
mx=my=leftbutton=rightbutton=shiftkey=ctrlkey=spacekey=upkey=downkey=leftkey=rightkey=wkey=akey=skey=dkey=ckey=fkey=0
w=c.width/2,h=c.height/2,t=0
hud=new Image()
showHud = false;
hud.src="hud1.png"
ctx=x
loadScene()
process()
